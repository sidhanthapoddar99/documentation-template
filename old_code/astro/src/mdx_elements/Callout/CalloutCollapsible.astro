---
/**
 * CalloutCollapsible - Expandable callout with details/summary
 *
 * Usage:
 * <CalloutCollapsible type="info" title="Click to expand">
 *   Hidden content here.
 * </CalloutCollapsible>
 */

export interface Props {
  type?: 'info' | 'warning' | 'danger' | 'success' | 'tip' | 'note';
  title?: string;
  open?: boolean;
  class?: string;
}

const { type = 'info', title = 'Details', open = false, class: className = '' } = Astro.props;

const icons: Record<string, string> = {
  info: '‚ÑπÔ∏è',
  warning: '‚ö†Ô∏è',
  danger: '‚ùå',
  success: '‚úÖ',
  tip: 'üí°',
  note: 'üìù',
};
---

<details class:list={['callout-collapsible', `callout-collapsible--${type}`, className]} open={open}>
  <summary class="callout-collapsible__summary">
    <span class="callout-collapsible__icon" aria-hidden="true">{icons[type]}</span>
    <span class="callout-collapsible__title">{title}</span>
    <svg class="callout-collapsible__chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <polyline points="6 9 12 15 18 9"/>
    </svg>
  </summary>
  <div class="callout-collapsible__content">
    <slot />
  </div>
</details>

<style>
  .callout-collapsible {
    margin: 1.5rem 0;
    border-radius: 0.5rem;
    border-left: 4px solid;
    overflow: hidden;
  }

  .callout-collapsible__summary {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    cursor: pointer;
    user-select: none;
    list-style: none;
  }

  .callout-collapsible__summary::-webkit-details-marker {
    display: none;
  }

  .callout-collapsible__summary:hover {
    opacity: 0.9;
  }

  .callout-collapsible__icon {
    font-size: 1rem;
    line-height: 1;
  }

  .callout-collapsible__title {
    flex: 1;
    font-weight: 600;
    font-size: 0.875rem;
  }

  .callout-collapsible__chevron {
    width: 1rem;
    height: 1rem;
    transition: transform 0.2s ease;
  }

  .callout-collapsible[open] .callout-collapsible__chevron {
    transform: rotate(180deg);
  }

  .callout-collapsible__content {
    padding: 0 1rem 1rem;
    font-size: 0.875rem;
    line-height: 1.625;
  }

  .callout-collapsible__content :global(p:first-child) {
    margin-top: 0;
  }

  .callout-collapsible__content :global(p:last-child) {
    margin-bottom: 0;
  }

  /* Type variants */
  .callout-collapsible--info {
    background-color: var(--callout-info-bg);
    border-left-color: var(--callout-info-border);
    color: var(--callout-info-text);
  }

  .callout-collapsible--warning {
    background-color: var(--callout-warning-bg);
    border-left-color: var(--callout-warning-border);
    color: var(--callout-warning-text);
  }

  .callout-collapsible--danger {
    background-color: var(--callout-danger-bg);
    border-left-color: var(--callout-danger-border);
    color: var(--callout-danger-text);
  }

  .callout-collapsible--success {
    background-color: var(--callout-success-bg);
    border-left-color: var(--callout-success-border);
    color: var(--callout-success-text);
  }

  .callout-collapsible--tip {
    background-color: var(--callout-tip-bg);
    border-left-color: var(--callout-tip-border);
    color: var(--callout-tip-text);
  }

  .callout-collapsible--note {
    background-color: var(--theme-bg-secondary);
    border-left-color: var(--theme-border-strong);
    color: var(--theme-text-primary);
  }
</style>
