graph TB
    subgraph "Layer 1: Network Security"
        Firewall[Firewall Rules]
        VPN[VPN Access]
        IPS[Intrusion Prevention]
        TLS[TLS 1.3]
    end
    
    subgraph "Layer 2: Application Security"
        InputVal[Input Validation]
        AuthN[Authentication]
        AuthZ[Authorization]
        SessionMgmt[Session Management]
    end
    
    subgraph "Layer 3: Cryptographic Security"
        E2E[End-to-End Encryption]
        KeyMgmt[Key Management]
        SecureRandom[Secure Random]
        CryptoAgility[Crypto Agility]
    end
    
    subgraph "Layer 4: Data Security"
        Encryption[Data Encryption]
        Tokenization[Tokenization]
        Masking[Data Masking]
        Backup[Secure Backup]
    end
    
    subgraph "Layer 5: Infrastructure Security"
        Hardening[OS Hardening]
        Patching[Patch Management]
        AccessCtrl[Access Control]
        Monitoring[Security Monitoring]
    end
    
    subgraph "Layer 6: Operational Security"
        Policies[Security Policies]
        Training[Security Training]
        Incident[Incident Response]
        Audit[Security Audits]
    end
    
    Firewall --> InputVal
    VPN --> InputVal
    IPS --> InputVal
    TLS --> InputVal
    
    InputVal --> E2E
    AuthN --> E2E
    AuthZ --> E2E
    SessionMgmt --> E2E
    
    E2E --> Encryption
    KeyMgmt --> Encryption
    SecureRandom --> Encryption
    CryptoAgility --> Encryption
    
    Encryption --> Hardening
    Tokenization --> Hardening
    Masking --> Hardening
    Backup --> Hardening
    
    Hardening --> Policies
    Patching --> Policies
    AccessCtrl --> Policies
    Monitoring --> Policies
    
    classDef layer1 fill:#ffebee,stroke:#c62828
    classDef layer2 fill:#f3e5f5,stroke:#4a148c
    classDef layer3 fill:#e8f5e9,stroke:#1b5e20
    classDef layer4 fill:#e3f2fd,stroke:#0d47a1
    classDef layer5 fill:#fff3e0,stroke:#e65100
    classDef layer6 fill:#fce4ec,stroke:#880e4f
    
    class Firewall,VPN,IPS,TLS layer1
    class InputVal,AuthN,AuthZ,SessionMgmt layer2
    class E2E,KeyMgmt,SecureRandom,CryptoAgility layer3
    class Encryption,Tokenization,Masking,Backup layer4
    class Hardening,Patching,AccessCtrl,Monitoring layer5
    class Policies,Training,Incident,Audit layer6