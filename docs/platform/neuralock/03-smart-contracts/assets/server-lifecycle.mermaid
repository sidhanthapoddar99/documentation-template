stateDiagram-v2
    [*] --> Unregistered: Initial State
    
    Unregistered --> Minted: mintServer()
    
    state Minted {
        [*] --> Unverified
        Unverified --> PendingVerification: updateMetadata()
        PendingVerification --> Unverified: Verification Failed/Expired
        PendingVerification --> Verified: approveMetadataUpdate()<br/>(threshold met)
    }
    
    Verified --> PendingUpdate: updateMetadata()
    PendingUpdate --> Verified: Update Approved
    PendingUpdate --> Verified: Update Rejected/Expired
    
    Minted --> Transferred: transferFrom()
    Transferred --> Minted: New Owner
    
    Minted --> Burned: burnServer()
    Burned --> [*]: End State
    
    state PendingVerification {
        [*] --> WaitingApprovals
        WaitingApprovals --> CollectingVotes: Manager Approves
        CollectingVotes --> CollectingVotes: More Approvals
        CollectingVotes --> ThresholdMet: Enough Approvals
        CollectingVotes --> Expired: Timeout
        ThresholdMet --> [*]: Execute Update
        Expired --> [*]: Revert to Previous
    }
    
    note right of Unverified
        - Server public key registered
        - NFT minted to operator
        - Not yet verified by managers
    end note
    
    note right of Verified
        - Fully operational server
        - Can participate in protocol
        - Metadata validated
    end note
    
    note left of PendingUpdate
        - Existing verified server
        - Proposed new metadata
        - Awaiting manager approvals
    end note