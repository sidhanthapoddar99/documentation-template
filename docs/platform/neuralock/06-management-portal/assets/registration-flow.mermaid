sequenceDiagram
    participant User
    participant Portal
    participant Validation
    participant Blockchain
    participant Registry Contract
    participant Server
    
    User->>Portal: Start Registration
    Portal->>User: Show Step 1 (Basic Info)
    User->>Portal: Enter recipient, name, description
    
    Portal->>User: Show Step 2 (Keys)
    User->>Portal: Enter public keys
    Portal->>Validation: Validate key format
    Validation->>Portal: Keys valid
    
    User->>Portal: Upload proof of ownership
    Portal->>Validation: Verify signature
    Validation->>Portal: Signature valid
    
    Portal->>User: Show Step 3 (Domain)
    User->>Portal: Enter domain, endpoints
    Portal->>Server: Test connectivity
    Server->>Portal: Connection successful
    
    Portal->>User: Show Step 4 (Review)
    Portal->>Blockchain: Estimate gas
    Blockchain->>Portal: Gas estimate
    
    User->>Portal: Confirm & Submit
    Portal->>Blockchain: Send transaction
    Blockchain->>Registry Contract: Mint NFT
    
    Registry Contract->>Registry Contract: Validate inputs
    Registry Contract->>Registry Contract: Mint token
    Registry Contract->>Registry Contract: Store metadata
    
    Registry Contract->>Blockchain: Emit ServerRegistered event
    Blockchain->>Portal: Transaction confirmed
    
    Portal->>User: Show success + NFT ID
    Portal->>Server: Notify registration
    Server->>Server: Configure for network
    
    Note over Portal,Server: Server can now participate in network