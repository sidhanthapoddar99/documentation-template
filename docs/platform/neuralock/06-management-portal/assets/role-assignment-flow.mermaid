sequenceDiagram
    participant Admin
    participant Portal
    participant Validation
    participant Blockchain
    participant Registry Contract
    participant Audit Service
    participant Target User
    
    Admin->>Portal: Access Role Management
    Portal->>Validation: Verify Admin Permissions
    Validation->>Portal: Permissions Confirmed
    
    Portal->>Admin: Show User List
    Admin->>Portal: Select User to Modify
    Portal->>Blockchain: Get Current User Role
    Blockchain->>Portal: Return Current Role
    
    Admin->>Portal: Select New Role
    Portal->>Portal: Show Confirmation Dialog
    
    Admin->>Portal: Add Change Reason (Optional)
    Admin->>Portal: Confirm Role Change
    
    Portal->>Validation: Validate Role Change
    Validation->>Validation: Check Role Hierarchy
    Validation->>Validation: Verify Target Not Self
    Validation->>Portal: Validation Passed
    
    Portal->>Blockchain: Submit Transaction
    
    Blockchain->>Registry Contract: grantRole(user, role)
    
    Registry Contract->>Registry Contract: Verify Caller is Admin
    Registry Contract->>Registry Contract: Check Role Validity
    Registry Contract->>Registry Contract: Update Role Mapping
    
    Registry Contract->>Blockchain: Emit RoleGranted Event
    
    Blockchain->>Portal: Transaction Success
    
    Portal->>Audit Service: Log Role Change
    Audit Service->>Audit Service: Create Audit Entry
    Audit Service->>Blockchain: Store Audit Hash
    
    Portal->>Target User: Send Notification
    Target User->>Target User: Receive Role Update
    
    Portal->>Admin: Show Success Message
    Portal->>Portal: Update UI State
    
    Note over Registry Contract: All role changes are permanent until explicitly changed
    Note over Audit Service: Audit trail is immutable and timestamped