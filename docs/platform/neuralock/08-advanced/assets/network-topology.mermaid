graph LR
    subgraph "Internet"
        Client[Client Application]
        Admin[Admin Portal]
    end
    
    subgraph "Edge Network"
        CDN[CDN/DDoS Protection<br/>Cloudflare]
        WAF[Web Application Firewall]
    end
    
    subgraph "Public Network"
        ALB[Application Load Balancer<br/>TLS Termination]
        API[API Gateway<br/>Rate Limiting]
    end
    
    subgraph "Private Network (VPC)"
        subgraph "Application Tier"
            S1[Neuralock Server 1]
            S2[Neuralock Server 2]
            S3[Neuralock Server 3]
            S4[Neuralock Server 4]
            S5[Neuralock Server 5]
        end
        
        subgraph "Data Tier"
            PG[(PostgreSQL<br/>Primary)]
            PGR[(PostgreSQL<br/>Replica)]
            Redis[(Redis Cache)]
            Backup[(Backup Storage)]
        end
        
        subgraph "Monitoring"
            Prom[Prometheus]
            Graf[Grafana]
            Logs[Log Aggregation]
        end
    end
    
    subgraph "Management Network"
        Bastion[Bastion Host]
        VPN[VPN Gateway]
    end
    
    %% Connections
    Client --> CDN
    Admin --> VPN
    CDN --> WAF
    WAF --> ALB
    ALB --> API
    API --> S1
    API --> S2
    API --> S3
    API --> S4
    API --> S5
    
    S1 --> PG
    S2 --> PG
    S3 --> PG
    S4 --> PGR
    S5 --> PGR
    
    S1 --> Redis
    S2 --> Redis
    S3 --> Redis
    S4 --> Redis
    S5 --> Redis
    
    S1 -.->|Metrics| Prom
    S2 -.->|Metrics| Prom
    S3 -.->|Metrics| Prom
    S4 -.->|Metrics| Prom
    S5 -.->|Metrics| Prom
    
    Prom --> Graf
    S1 -.->|Logs| Logs
    S2 -.->|Logs| Logs
    S3 -.->|Logs| Logs
    S4 -.->|Logs| Logs
    S5 -.->|Logs| Logs
    
    VPN --> Bastion
    Bastion --> S1
    
    PG --> Backup
    
    %% Server-to-server mesh
    S1 <-.->|Internal TLS| S2
    S1 <-.->|Internal TLS| S3
    S1 <-.->|Internal TLS| S4
    S1 <-.->|Internal TLS| S5
    S2 <-.->|Internal TLS| S3
    S2 <-.->|Internal TLS| S4
    S2 <-.->|Internal TLS| S5
    S3 <-.->|Internal TLS| S4
    S3 <-.->|Internal TLS| S5
    S4 <-.->|Internal TLS| S5
    
    style CDN fill:#e3f2fd
    style ALB fill:#c5e1a5
    style S1 fill:#fff9c4
    style S2 fill:#fff9c4
    style S3 fill:#fff9c4
    style S4 fill:#fff9c4
    style S5 fill:#fff9c4
    style PG fill:#ffccbc
    style Redis fill:#ffccbc