graph TB
    subgraph "Permission Levels"
        None[0 - None<br/>No Access]
        Read[1 - Read<br/>Can Decrypt]
        Write[2 - Write<br/>Can Update]
        Full[3 - Full<br/>Read + Write]
    end
    
    subgraph "Smart Contract Layer"
        AppContract[Application Contract<br/>INeuralock Interface]
        PermCheck[Permission Check<br/>neuralock(user, objectId)]
        AccessControl[Access Control<br/>Mapping]
    end
    
    subgraph "Permission Operations"
        Grant[Grant Access<br/>updatePermissions()]
        Revoke[Revoke Access<br/>setPermission(0)]
        Transfer[Transfer Ownership<br/>transferOwnership()]
        Check[Check Permission<br/>checkPermission()]
    end
    
    subgraph "Enforcement Points"
        EncryptOp[Encrypt Operation<br/>Owner Only]
        DecryptOp[Decrypt Operation<br/>Read or Full]
        UpdateOp[Update Operation<br/>Write or Full]
        ShareOp[Share Operation<br/>Owner Only]
    end
    
    %% Permission flow
    AppContract --> PermCheck
    PermCheck --> AccessControl
    AccessControl --> None
    AccessControl --> Read
    AccessControl --> Write
    AccessControl --> Full
    
    %% Operations
    Grant --> AccessControl
    Revoke --> AccessControl
    Transfer --> AccessControl
    Check --> PermCheck
    
    %% Enforcement
    DecryptOp -.->|Requires| Read
    DecryptOp -.->|Requires| Full
    UpdateOp -.->|Requires| Write
    UpdateOp -.->|Requires| Full
    EncryptOp -.->|Owner| AppContract
    ShareOp -.->|Owner| AppContract
    
    style None fill:#ffcccc
    style Read fill:#ccffcc
    style Write fill:#ccccff
    style Full fill:#ffffcc
    style AppContract fill:#e1f5e1
    style PermCheck fill:#ffe1e1
    style AccessControl fill:#e1e1ff